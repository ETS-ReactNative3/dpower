<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="theme-color" content="#007dfa" />
  <meta name="description" content="Firstdigital, agence digital web, sécurité web, graphisme, webdesign, ecommerce" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script async
    src="https://www.googletagmanager.com/gtag/js?id=<%= htmlWebpackPlugin.options.ga_property_id %>"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', '<%= htmlWebpackPlugin.options.ga_property_id %>');
  </script>
  <title><%= htmlWebpackPlugin.options.title %></title>
  <link rel="canonical" href=<%= htmlWebpackPlugin.options.url %> />
</head>

<body>
  <noscript>
    You don't have javascript enabled. Good luck with that.
  </noscript>
  <div id="root"></div>
</body>

<script>
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      navigator.serviceWorker.register('/service-worker.js').then(registration => {
        console.log('SW registered: ', registration);
      }).catch(registrationError => {
        console.log('SW registration failed: ', registrationError);
      });
    });
  }

  let CACHE_NAME = 'sw-v1'
  self.addEventListener('install', (event) => {
    event.waitUntil(
      caches.open(CACHE_NAME)
        .then(cache => cache.addAll('./404.html'))
    )
  })
  self.addEventListener('fetch', (event) => {
    if (event.request.method === 'GET') {
      event.respondWith(
        caches.match(event.request)
          .then((cached) => {
            var networked = fetch(event.request)
              .then((response) => {
                let cacheCopy = response.clone()
                caches.open(CACHE_NAME)
                  .then(cache => cache.put(event.request, cacheCopy))
                return response;
              })
              .catch(() => caches.match(offlinePage));
            return cached || networked;
          })
      )
    }
    return;
  });
</script>

</html>